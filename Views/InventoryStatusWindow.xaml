<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="CycleDesk.InventoryStatusWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:CycleDesk.Controls"
        Title="CycleDesk - Inventory Status" 
        Height="900" 
        Width="1600"
        WindowStartupLocation="CenterScreen"
        Background="#FFF5F5F5"
        WindowState="Maximized">

    <Window.Resources>
        <!-- ComboBox Style for Filters -->
        <Style x:Key="FilterComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#FFF8F9FA"/>
            <Setter Property="BorderBrush" Value="#FFDEE2E6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#FF2D3E50"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Padding" Value="15,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Focusable="False"
                                IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                ClickMode="Press">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border Background="{TemplateBinding Background}"
                                               BorderBrush="{TemplateBinding BorderBrush}"
                                               BorderThickness="{TemplateBinding BorderThickness}"
                                               CornerRadius="8">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <ContentPresenter Grid.Column="0"
                                                        Margin="15,0,0,0"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Left"/>
                                                <TextBlock Grid.Column="1"
                                                         Text="▼"
                                                         FontSize="10"
                                                         Foreground="#FF6C757D"
                                                         Margin="0,0,15,0"
                                                         VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>

                            <ContentPresenter x:Name="ContentSite"
                                    Content="{TemplateBinding SelectionBoxItem}"
                                    ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                    Margin="15,0,30,0"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Left"
                                    IsHitTestVisible="False"/>

                            <Popup x:Name="PART_Popup"
                                  Placement="Bottom"
                                  IsOpen="{TemplateBinding IsDropDownOpen}"
                                  AllowsTransparency="True"
                                  Focusable="False"
                                  PopupAnimation="Slide">
                                <Border Background="White"
                                       BorderBrush="#FFDEE2E6"
                                       BorderThickness="1"
                                       CornerRadius="8"
                                       Margin="0,5,0,0"
                                       MinWidth="{TemplateBinding ActualWidth}">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="10" ShadowDepth="0" Opacity="0.15"/>
                                    </Border.Effect>
                                    <ScrollViewer MaxHeight="200" Margin="0">
                                        <ItemsPresenter/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBoxItem Style -->
        <Style TargetType="ComboBoxItem">
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border Background="{TemplateBinding Background}"
                               Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" Value="#FFF8F9FA"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#FFE9ECEF"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <controls:SideMenuControl x:Name="sideMenu" DockPanel.Dock="Left" />

        <!-- GŁÓWNA ZAWARTOŚĆ -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="80"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Górny bar -->
            <Border Grid.Row="0" 
                   Background="White" 
                   BorderBrush="#FFE0E0E0" 
                   BorderThickness="0,0,0,1"
                   Padding="30,0">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="📊" FontSize="32" Margin="0,0,15,0"/>
                        <TextBlock Text="Inventory Status"
                                  FontSize="28"
                                  FontWeight="Bold"
                                  Foreground="#FF2D3E50"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content -->
            <ScrollViewer Grid.Row="1" 
                         VerticalScrollBarVisibility="Auto"
                         Padding="30">
                <StackPanel>

                    <!-- KPI CARDS -->
                    <Grid Margin="0,0,0,30">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Out of Stock Card -->
                        <Border Grid.Column="0" 
                               Background="White" 
                               CornerRadius="15"
                               Margin="0,0,15,0"
                               Padding="30"
                               Height="180">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="15" 
                                                ShadowDepth="0" 
                                                Opacity="0.1" 
                                                Color="Black"/>
                            </Border.Effect>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0"
                                          Text="Out of Stock"
                                          FontSize="16"
                                          Foreground="#FF6C757D"
                                          Margin="0,0,0,15"/>

                                <TextBlock x:Name="txtOutOfStockCount"
                                          Grid.Row="1"
                                          Text="0"
                                          FontSize="36"
                                          FontWeight="Bold"
                                          Foreground="#FF2D3E50"
                                          VerticalAlignment="Center"/>

                                <TextBlock Grid.Row="2"
                                          Text="⚠️ Critical"
                                          FontSize="13"
                                          Foreground="#FFDC3545"
                                          FontWeight="SemiBold"/>
                            </Grid>
                        </Border>

                        <!-- Low Stock Card -->
                        <Border Grid.Column="1" 
                               Background="White" 
                               CornerRadius="15"
                               Margin="0,0,15,0"
                               Padding="30"
                               Height="180">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="15" 
                                                ShadowDepth="0" 
                                                Opacity="0.1" 
                                                Color="Black"/>
                            </Border.Effect>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0"
                                          Text="Low Stock"
                                          FontSize="16"
                                          Foreground="#FF6C757D"
                                          Margin="0,0,0,15"/>

                                <TextBlock x:Name="txtLowStockCount"
                                          Grid.Row="1"
                                          Text="0"
                                          FontSize="36"
                                          FontWeight="Bold"
                                          Foreground="#FF2D3E50"
                                          VerticalAlignment="Center"/>

                                <TextBlock Grid.Row="2"
                                          Text="⚠️ Needs attention"
                                          FontSize="13"
                                          Foreground="#FFFFC107"
                                          FontWeight="SemiBold"/>
                            </Grid>
                        </Border>

                        <!-- In Stock Card -->
                        <Border Grid.Column="2" 
                               Background="White" 
                               CornerRadius="15"
                               Margin="0,0,15,0"
                               Padding="30"
                               Height="180">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="15" 
                                                ShadowDepth="0" 
                                                Opacity="0.1" 
                                                Color="Black"/>
                            </Border.Effect>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0"
                                          Text="In Stock"
                                          FontSize="16"
                                          Foreground="#FF6C757D"
                                          Margin="0,0,0,15"/>

                                <TextBlock x:Name="txtInStockCount"
                                          Grid.Row="1"
                                          Text="0"
                                          FontSize="36"
                                          FontWeight="Bold"
                                          Foreground="#FF2D3E50"
                                          VerticalAlignment="Center"/>

                                <TextBlock Grid.Row="2"
                                          Text="✓ Good"
                                          FontSize="13"
                                          Foreground="#FF28A745"
                                          FontWeight="SemiBold"/>
                            </Grid>
                        </Border>

                        <!-- Total Items Card -->
                        <Border Grid.Column="3" 
                               Background="White" 
                               CornerRadius="15"
                               Padding="30"
                               Height="180">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="15" 
                                                ShadowDepth="0" 
                                                Opacity="0.1" 
                                                Color="Black"/>
                            </Border.Effect>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0"
                                          Text="Total Items"
                                          FontSize="16"
                                          Foreground="#FF6C757D"
                                          Margin="0,0,0,15"/>

                                <TextBlock x:Name="txtTotalCount"
                                          Grid.Row="1"
                                          Text="0"
                                          FontSize="36"
                                          FontWeight="Bold"
                                          Foreground="#FF2D3E50"
                                          VerticalAlignment="Center"/>

                                <TextBlock Grid.Row="2"
                                          Text="products"
                                          FontSize="13"
                                          Foreground="#FF6C757D"
                                          FontWeight="SemiBold"/>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- WHITE CONTENT BOX -->
                    <Border Background="White"
                           CornerRadius="15"
                           Padding="30">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="15" 
                                            ShadowDepth="0" 
                                            Opacity="0.1" 
                                            Color="Black"/>
                        </Border.Effect>

                        <StackPanel>
                            <!-- Search & Filters -->
                            <Grid Margin="0,0,0,30">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="350"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Search Box -->
                                <Border Grid.Column="0"
                                       Background="#FFF8F9FA"
                                       CornerRadius="10"
                                       Padding="15,12"
                                       BorderBrush="#FFDEE2E6"
                                       BorderThickness="1">
                                    <Grid>
                                        <!-- Search Icon -->
                                        <Viewbox Width="18" Height="18" 
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Margin="0,0,10,0">
                                            <Canvas Width="24" Height="24">
                                                <Path Data="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                                                      Fill="#FF2D3E50"/>
                                            </Canvas>
                                        </Viewbox>

                                        <TextBox x:Name="txtSearch"
                                                Text=""
                                                TextChanged="txtSearch_TextChanged"
                                                FontSize="14"
                                                Foreground="#FF2D3E50"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                VerticalAlignment="Center"
                                                Padding="35,0,0,0">
                                            <TextBox.Style>
                                                <Style TargetType="TextBox">
                                                    <Style.Triggers>
                                                        <Trigger Property="Text" Value="">
                                                            <Setter Property="Background">
                                                                <Setter.Value>
                                                                    <VisualBrush Stretch="None" AlignmentX="Left">
                                                                        <VisualBrush.Visual>
                                                                            <TextBlock Text="Search Product..." 
                                                                                      Foreground="#FF6C757D" 
                                                                                      FontSize="14"
                                                                                      Margin="30,0,0,0"/>
                                                                        </VisualBrush.Visual>
                                                                    </VisualBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBox.Style>
                                        </TextBox>
                                    </Grid>
                                </Border>


                                <!-- Filters -->
                                <StackPanel Grid.Column="1"
                                           Orientation="Horizontal"
                                           HorizontalAlignment="Right">

                                    <!-- Category Filter -->
                                    <ComboBox x:Name="cmbCategory"
                                             Width="160"
                                             Height="44"
                                             FontSize="13"
                                             Margin="0,0,10,0"
                                             SelectionChanged="cmbCategory_SelectionChanged"
                                             Style="{StaticResource FilterComboBoxStyle}">
                                        <ComboBoxItem Content="All Categories" IsSelected="True" Tag="0"/>
                                    </ComboBox>

                                    <!-- Status Filter -->
                                    <ComboBox x:Name="cmbStatus"
                                             Width="150"
                                             Height="44"
                                             FontSize="13"
                                             Margin="0,0,10,0"
                                             SelectionChanged="cmbStatus_SelectionChanged"
                                             Style="{StaticResource FilterComboBoxStyle}">
                                        <ComboBoxItem Content="All Status" IsSelected="True"/>
                                        <ComboBoxItem Content="In Stock"/>
                                        <ComboBoxItem Content="Low Stock"/>
                                        <ComboBoxItem Content="Critical"/>
                                        <ComboBoxItem Content="Out of Stock"/>
                                    </ComboBox>

                                    <!-- Refresh Button -->
                                    <Button Width="44"
                                           Height="44"
                                           Margin="0,0,10,0"
                                           Background="#FFF8F9FA"
                                           BorderBrush="#FFDEE2E6"
                                           BorderThickness="1"
                                           Cursor="Hand"
                                           Click="RefreshButton_Click">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="{TemplateBinding Background}"
                                                                   BorderBrush="{TemplateBinding BorderBrush}"
                                                                   BorderThickness="{TemplateBinding BorderThickness}"
                                                                   CornerRadius="8">
                                                                <Viewbox Width="18" Height="18">
                                                                    <Canvas Width="24" Height="24">
                                                                        <Path Data="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
                                                                              Fill="#FF2D3E50"/>
                                                                    </Canvas>
                                                                </Viewbox>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#FFE9ECEF"/>
                                                    </Trigger>
                                                    <Trigger Property="IsPressed" Value="True">
                                                        <Setter Property="Background" Value="#FFDEE2E6"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>

                                    <!-- Export CSV Button -->
                                    <Button Content="📥 Export CSV"
                                           Height="44"
                                           Padding="22,0"
                                           Background="#FF2D3E50"
                                           Foreground="White"
                                           BorderThickness="0"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           Cursor="Hand"
                                           Click="ExportCsv_Click">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="{TemplateBinding Background}"
                                                                   CornerRadius="8"
                                                                   Padding="{TemplateBinding Padding}">
                                                                <ContentPresenter HorizontalAlignment="Center"
                                                                                VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#FF1E2A36"/>
                                                    </Trigger>
                                                    <Trigger Property="IsPressed" Value="True">
                                                        <Setter Property="Background" Value="#FF141D28"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <!-- Inventory Status Table -->
                            <Border BorderBrush="#FFDEE2E6"
                                   BorderThickness="1"
                                   CornerRadius="15">
                                <StackPanel>
                                    <!-- Header z zaokrąglonymi górnymi rogami -->
                                    <Border Background="#FF2D3E50" 
                                           CornerRadius="15,15,0,0" 
                                           Height="50">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Column 0 - Image -->
                                            <Border Grid.Column="0" BorderBrush="#FF4A5568" BorderThickness="0,0,1,0" Padding="15,0">
                                                <TextBlock Text="Image" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>

                                            <!-- Column 1 - SKU -->
                                            <Border Grid.Column="1" BorderBrush="#FF4A5568" BorderThickness="0,0,1,0" Padding="15,0">
                                                <TextBlock Text="SKU" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>

                                            <!-- Column 2 - Product Name -->
                                            <Border Grid.Column="2" BorderBrush="#FF4A5568" BorderThickness="0,0,1,0" Padding="15,0">
                                                <TextBlock Text="Product Name" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>

                                            <!-- Column 3 - Category -->
                                            <Border Grid.Column="3" BorderBrush="#FF4A5568" BorderThickness="0,0,1,0" Padding="15,0">
                                                <TextBlock Text="Category" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>

                                            <!-- Column 4 - Stock -->
                                            <Border Grid.Column="4" BorderBrush="#FF4A5568" BorderThickness="0,0,1,0" Padding="15,0">
                                                <TextBlock Text="Stock" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>

                                            <!-- Column 5 - Reorder -->
                                            <Border Grid.Column="5" BorderBrush="#FF4A5568" BorderThickness="0,0,1,0" Padding="15,0">
                                                <TextBlock Text="Reorder" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>

                                            <!-- Column 6 - Status -->
                                            <Border Grid.Column="6" Padding="15,0">
                                                <TextBlock Text="Status" FontSize="12" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center" TextAlignment="Center"/>
                                            </Border>
                                        </Grid>
                                    </Border>

                                    <!-- Product Rows - DYNAMICZNIE GENEROWANE -->
                                    <StackPanel x:Name="inventoryContainer">
                                        <!-- Wiersze będą generowane z kodu C# -->
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>